/*
 Copyright 2016 Google Inc. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
(function(t,r){'object'==typeof exports&&'undefined'!=typeof module?module.exports=r():'function'==typeof define&&define.amd?define(r):(t.goog=t.goog||{},t.goog.swlib=r())})(this,function(){'use strict';function createCommonjsModule(le,ue){return ue={exports:{}},le(ue,ue.exports),ue.exports}function throwError(le){const ue=new Error(le),pe=l.parse(ue);throw 3<=pe.length&&(ue.message=`Invalid call to ${pe[2].functionName}() â€” `+le.replace(/\s+/g,' '),ue.name=pe[1].functionName.replace(/^Object\./,'')),ue}function parse(le,ue){for(var ye,pe=[],he=0,ge=0,me='',fe=ue&&ue.delimiter||'/';null!=(ye=x.exec(le));){var _e=ye[0],be=ye[1],ve=ye.index;if(me+=le.slice(ge,ve),ge=ve+_e.length,be){me+=be[1];continue}var Ee=le[ge],Ne=ye[2],Ce=ye[3],xe=ye[4],ke=ye[5],qe=ye[6],Oe=ye[7];me&&(pe.push(me),me='');var Ie=ye[2]||fe,Ae=xe||ke;pe.push({name:Ce||he++,prefix:Ne||'',delimiter:Ie,optional:'?'===qe||'*'===qe,repeat:'+'===qe||'*'===qe,partial:null!=Ne&&null!=Ee&&Ee!==Ne,asterisk:!!Oe,pattern:Ae?escapeGroup(Ae):Oe?'.*':'[^'+escapeString(Ie)+']+?'})}return ge<le.length&&(me+=le.substr(ge)),me&&pe.push(me),pe}function encodeURIComponentPretty(le){return encodeURI(le).replace(/[\/?#]/g,function(ue){return'%'+ue.charCodeAt(0).toString(16).toUpperCase()})}function encodeAsterisk(le){return encodeURI(le).replace(/[?#]/g,function(ue){return'%'+ue.charCodeAt(0).toString(16).toUpperCase()})}function tokensToFunction(le){for(var ue=Array(le.length),pe=0;pe<le.length;pe++)'object'==typeof le[pe]&&(ue[pe]=new RegExp('^(?:'+le[pe].pattern+')$'));return function(he,ge){for(var ve,me='',fe=he||{},ye=ge||{},_e=ye.pretty?encodeURIComponentPretty:encodeURIComponent,be=0;be<le.length;be++){if(ve=le[be],'string'==typeof ve){me+=ve;continue}var Ne,Ee=fe[ve.name];if(null==Ee)if(ve.optional){ve.partial&&(me+=ve.prefix);continue}else throw new TypeError('Expected "'+ve.name+'" to be defined');if(y(Ee)){if(!ve.repeat)throw new TypeError('Expected "'+ve.name+'" to not repeat, but received `'+JSON.stringify(Ee)+'`');if(0===Ee.length)if(ve.optional)continue;else throw new TypeError('Expected "'+ve.name+'" to not be empty');for(var Ce=0;Ce<Ee.length;Ce++){if(Ne=_e(Ee[Ce]),!ue[be].test(Ne))throw new TypeError('Expected all "'+ve.name+'" to match "'+ve.pattern+'", but received `'+JSON.stringify(Ne)+'`');me+=(0===Ce?ve.prefix:ve.delimiter)+Ne}continue}if(Ne=ve.asterisk?encodeAsterisk(Ee):_e(Ee),!ue[be].test(Ne))throw new TypeError('Expected "'+ve.name+'" to match "'+ve.pattern+'", but received "'+Ne+'"');me+=ve.prefix+Ne}return me}}function escapeString(le){return le.replace(/([.+*?=^!:${}()[\]|\/\\])/g,'\\$1')}function escapeGroup(le){return le.replace(/([=!:$\/()])/g,'\\$1')}function attachKeys(le,ue){return le.keys=ue,le}function flags(le){return le.sensitive?'':'i'}function regexpToRegexp(le,ue){var pe=le.source.match(/\((?!\?)/g);if(pe)for(var he=0;he<pe.length;he++)ue.push({name:he,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return attachKeys(le,ue)}function arrayToRegexp(le,ue,pe){for(var he=[],ge=0;ge<le.length;ge++)he.push(pathToRegexp(le[ge],ue,pe).source);var me=new RegExp('(?:'+he.join('|')+')',flags(pe));return attachKeys(me,ue)}function stringToRegexp(le,ue,pe){return tokensToRegExp(parse(le,pe),ue,pe)}function tokensToRegExp(le,ue,pe){y(ue)||(pe=ue||pe,ue=[]),pe=pe||{};for(var ye,he=pe.strict,ge=!1!==pe.end,me='',fe=0;fe<le.length;fe++)if(ye=le[fe],'string'==typeof ye)me+=escapeString(ye);else{var _e=escapeString(ye.prefix),be='(?:'+ye.pattern+')';ue.push(ye),ye.repeat&&(be+='(?:'+_e+be+')*'),be=ye.optional?ye.partial?_e+'('+be+')?':'(?:'+_e+'('+be+'))?':_e+'('+be+')',me+=be}var ve=escapeString(pe.delimiter||'/'),Ee=me.slice(-ve.length)===ve;return he||(me=(Ee?me.slice(0,-ve.length):me)+'(?:'+ve+'(?=$))?'),me+=ge?'$':he&&Ee?'':'(?='+ve+'|$)',attachKeys(new RegExp('^'+me,flags(pe)),ue)}function pathToRegexp(le,ue,pe){return y(ue)||(pe=ue||pe,ue=[]),pe=pe||{},le instanceof RegExp?regexpToRegexp(le,ue):y(le)?arrayToRegexp(le,ue,pe):stringToRegexp(le,ue,pe)}function broadcastUpdate({channel:le,cacheName:ue,url:pe,source:he}){u.isInstance({channel:le},BroadcastChannel),u.isType({cacheName:ue},'string'),u.isType({source:he},'string'),u.isType({url:pe},'string'),le.postMessage({type:X,meta:he,payload:{cacheName:ue,updatedUrl:pe}})}function responsesAreSame({first:le,second:ue,headersToCheck:pe}={}){if(!(le instanceof Response&&ue instanceof Response&&pe instanceof Array))throw z.createError('responses-are-same-parameters-required');return pe.every((he)=>{return le.headers.has(he)===ue.headers.has(he)&&le.headers.get(he)===ue.headers.get(he)})}class ErrorFactory$1{constructor(le){this._errors=le}createError(le,ue){if(!(le in this._errors))throw new Error(`Unable to generate error '${le}'.`);let pe=this._errors[le].replace(/\s+/g,' '),he=null;ue&&(pe+=` [${ue.message}]`,he=ue.stack);const ge=new Error;return ge.name=le,ge.message=pe,ge.stack=he,ge}}const t={'not-in-sw':'sw-lib must be loaded in your service worker file.','unsupported-route-type':'Routes must be either a express style route string, a Regex to capture request URLs or a Route instance.','empty-express-string':'The Express style route string must have some characters, an empty string is invalid.','bad-revisioned-cache-list':`The 'cacheRevisionedAssets()' method expects`+`an array of revisioned urls like so: ['/example/hello.1234.txt', `+`{path: 'hello.txt', revision: '1234'}]`,'navigation-route-url-string':`The registerNavigationRoute() method `+`expects a URL string as its first parameter.`};var r=new ErrorFactory$1(t);const a={'express-route-invalid-path':`When using ExpressRoute, you must
    provide a path that starts with a '/' character (to match same-origin
    requests) or that starts with 'http' (to match cross-origin requests)`};var s=new ErrorFactory$1(a),o='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,d=createCommonjsModule(function(le){(function(pe,he){'use strict';le.exports=he()})(o,function(){'use strict';function _isNumber(be){return!isNaN(parseFloat(be))&&isFinite(be)}function _capitalize(be){return be[0].toUpperCase()+be.substring(1)}function _getter(be){return function(){return this[be]}}function StackFrame(be){if(be instanceof Object)for(var ve=pe.concat(he.concat(ge.concat(me))),Ee=0;Ee<ve.length;Ee++)be.hasOwnProperty(ve[Ee])&&void 0!==be[ve[Ee]]&&this['set'+_capitalize(ve[Ee])](be[ve[Ee]])}var pe=['isConstructor','isEval','isNative','isToplevel'],he=['columnNumber','lineNumber'],ge=['fileName','functionName','source'],me=['args'];StackFrame.prototype={getArgs:function(){return this.args},setArgs:function(be){if('[object Array]'!==Object.prototype.toString.call(be))throw new TypeError('Args must be an Array');this.args=be},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(be){if(be instanceof StackFrame)this.evalOrigin=be;else if(be instanceof Object)this.evalOrigin=new StackFrame(be);else throw new TypeError('Eval Origin must be an Object or StackFrame')},toString:function(){var be=this.getFunctionName()||'{anonymous}',ve='('+(this.getArgs()||[]).join(',')+')',Ee=this.getFileName()?'@'+this.getFileName():'',Ne=_isNumber(this.getLineNumber())?':'+this.getLineNumber():'',Ce=_isNumber(this.getColumnNumber())?':'+this.getColumnNumber():'';return be+ve+Ee+Ne+Ce}};for(var fe=0;fe<pe.length;fe++)StackFrame.prototype['get'+_capitalize(pe[fe])]=_getter(pe[fe]),StackFrame.prototype['set'+_capitalize(pe[fe])]=function(be){return function(ve){this[be]=!!ve}}(pe[fe]);for(var ye=0;ye<he.length;ye++)StackFrame.prototype['get'+_capitalize(he[ye])]=_getter(he[ye]),StackFrame.prototype['set'+_capitalize(he[ye])]=function(be){return function(ve){if(!_isNumber(ve))throw new TypeError(be+' must be a Number');this[be]=+ve}}(he[ye]);for(var _e=0;_e<ge.length;_e++)StackFrame.prototype['get'+_capitalize(ge[_e])]=_getter(ge[_e]),StackFrame.prototype['set'+_capitalize(ge[_e])]=function(be){return function(ve){this[be]=ve+''}}(ge[_e]);return StackFrame})}),l=createCommonjsModule(function(le){(function(pe,he){'use strict';le.exports=he(d)})(o,function ErrorStackParser(pe){'use strict';var he=/(^|@)\S+\:\d+/,ge=/^\s*at .*(\S+\:\d+|\(native\))/m,me=/^(eval@)?(\[native code\])?$/;return{parse:function ErrorStackParser$$parse(fe){if('undefined'!=typeof fe.stacktrace||'undefined'!=typeof fe['opera#sourceloc'])return this.parseOpera(fe);if(fe.stack&&fe.stack.match(ge))return this.parseV8OrIE(fe);if(fe.stack)return this.parseFFOrSafari(fe);throw new Error('Cannot parse given Error object')},extractLocation:function ErrorStackParser$$extractLocation(fe){if(-1===fe.indexOf(':'))return[fe];var ye=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,_e=ye.exec(fe.replace(/[\(\)]/g,''));return[_e[1],_e[2]||void 0,_e[3]||void 0]},parseV8OrIE:function ErrorStackParser$$parseV8OrIE(fe){var ye=fe.stack.split('\n').filter(function(_e){return!!_e.match(ge)},this);return ye.map(function(_e){-1<_e.indexOf('(eval ')&&(_e=_e.replace(/eval code/g,'eval').replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,''));var be=_e.replace(/^\s+/,'').replace(/\(eval code/g,'(').split(/\s+/).slice(1),ve=this.extractLocation(be.pop()),Ee=be.join(' ')||void 0,Ne=-1<['eval','<anonymous>'].indexOf(ve[0])?void 0:ve[0];return new pe({functionName:Ee,fileName:Ne,lineNumber:ve[1],columnNumber:ve[2],source:_e})},this)},parseFFOrSafari:function ErrorStackParser$$parseFFOrSafari(fe){var ye=fe.stack.split('\n').filter(function(_e){return!_e.match(me)},this);return ye.map(function(_e){if(-1<_e.indexOf(' > eval')&&(_e=_e.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,':$1')),-1===_e.indexOf('@')&&-1===_e.indexOf(':'))return new pe({functionName:_e});var be=_e.split('@'),ve=this.extractLocation(be.pop()),Ee=be.join('@')||void 0;return new pe({functionName:Ee,fileName:ve[0],lineNumber:ve[1],columnNumber:ve[2],source:_e})},this)},parseOpera:function ErrorStackParser$$parseOpera(fe){return!fe.stacktrace||-1<fe.message.indexOf('\n')&&fe.message.split('\n').length>fe.stacktrace.split('\n').length?this.parseOpera9(fe):fe.stack?this.parseOpera11(fe):this.parseOpera10(fe)},parseOpera9:function ErrorStackParser$$parseOpera9(fe){for(var Ne,ye=/Line (\d+).*script (?:in )?(\S+)/i,_e=fe.message.split('\n'),be=[],ve=2,Ee=_e.length;ve<Ee;ve+=2)Ne=ye.exec(_e[ve]),Ne&&be.push(new pe({fileName:Ne[2],lineNumber:Ne[1],source:_e[ve]}));return be},parseOpera10:function ErrorStackParser$$parseOpera10(fe){for(var Ne,ye=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,_e=fe.stacktrace.split('\n'),be=[],ve=0,Ee=_e.length;ve<Ee;ve+=2)Ne=ye.exec(_e[ve]),Ne&&be.push(new pe({functionName:Ne[3]||void 0,fileName:Ne[2],lineNumber:Ne[1],source:_e[ve]}));return be},parseOpera11:function ErrorStackParser$$parseOpera11(fe){var ye=fe.stack.split('\n').filter(function(_e){return!!_e.match(he)&&!_e.match(/^Error created at/)},this);return ye.map(function(_e){var be=_e.split('@'),ve=this.extractLocation(be.pop()),Ee=be.shift()||'',Ne=Ee.replace(/<anonymous function(: (\w+))?>/,'$2').replace(/\([^\)]*\)/g,'')||void 0,Ce;Ee.match(/\(([^\)]*)\)/)&&(Ce=Ee.replace(/^[^\(]+\(([^\)]*)\)$/,'$1'));var xe=Ce===void 0||'[arguments not available]'===Ce?void 0:Ce.split(',');return new pe({functionName:Ne,args:xe,fileName:ve[0],lineNumber:ve[1],columnNumber:ve[2],source:_e})},this)}}})}),u={atLeastOne:function atLeastOne(le){const ue=Object.keys(le);ue.some((pe)=>le[pe]!==void 0)||throwError('Please set at least one of the following parameters: '+ue.map((pe)=>`'${pe}'`).join(', '))},hasMethod:function hasMethod(le,ue){const pe=Object.keys(le).pop(),he=typeof le[pe][ue];'function'!=he&&throwError(`The '${pe}' parameter must be an object that exposes a
      '${ue}' method.`)},isInstance:function isInstance(le,ue){const pe=Object.keys(le).pop();le[pe]instanceof ue||throwError(`The '${pe}' parameter must be an instance of
      '${ue.name}'`)},isOneOf:function isOneOf(le,ue){const pe=Object.keys(le).pop();ue.includes(le[pe])||throwError(`The '${pe}' parameter must be set to one of the
      following: ${ue}`)},isType:function isType(le,ue){const pe=Object.keys(le).pop(),he=typeof le[pe];he!==ue&&throwError(`The '${pe}' parameter has the wrong type. (Expected:
      ${ue}, actual: ${he})`)},isSWEnv:function isSWEnv(){return'ServiceWorkerGlobalScope'in self&&self instanceof ServiceWorkerGlobalScope},isValue:function isValue(le,ue){const pe=Object.keys(le).pop(),he=le[pe];he!==ue&&throwError(`The '${pe}' parameter has the wrong value. (Expected: 
      ${ue}, actual: ${he})`)},isArrayOfType:function isArrayOfType(le,ue){const pe=Object.keys(le).pop(),he=`The '${pe}' parameter should be an array containing
    one or more '${ue}' elements.`;Array.isArray(le[pe])||throwError(he);for(let ge of le[pe])typeof ge!==ue&&throwError(he)},isArrayOfClass:function isArrayOfClass(le,ue){const pe=Object.keys(le).pop(),he=`The '${pe}' parameter should be an array containing
    one or more '${ue.name}' instances.`;Array.isArray(le[pe])||throwError(he);for(let ge of le[pe])ge instanceof ue||throwError(he)}};const g=['DELETE','GET','HEAD','POST','PUT'];class Route{constructor({match:le,handler:ue,method:pe}={}){u.isType({match:le},'function'),'object'==typeof ue?u.hasMethod({handler:ue},'handle'):u.isType({handler:ue},'function'),this.match=le,this.handler='function'==typeof ue?{handle:ue}:ue,pe?(u.isOneOf({method:pe},g),this.method=pe):this.method='GET'}}var f=Array.isArray||function(le){return'[object Array]'==Object.prototype.toString.call(le)},y=f,_=pathToRegexp,x=new RegExp(['(\\\\.)','([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))'].join('|'),'g');_.parse=parse,_.compile=function compile(le,ue){return tokensToFunction(parse(le,ue))},_.tokensToFunction=tokensToFunction,_.tokensToRegExp=tokensToRegExp;class ExpressRoute extends Route{constructor({path:le,handler:ue,method:pe}){if(!(le.startsWith('/')||le.startsWith('http')))throw s.createError('express-route-invalid-path');let he=[];const ge=_(le,he);super({match:({url:fe})=>{if(le.startsWith('/')&&fe.origin!==location.origin)return null;const ye=le.startsWith('/')?fe.pathname:fe.href,_e=ye.match(ge);if(!_e)return null;const be={};return he.forEach((ve,Ee)=>{be[ve.name]=_e[Ee+1]}),be},handler:ue,method:pe})}}class LogGroup{constructor({title:le,isPrimary:ue}={}){this._isPrimary=ue||!1,this._groupTitle=le||'',this._logs=[],this._childGroups=[],this._isFirefox=!1,/Firefox\/\d*\.\d*/.exec(navigator.userAgent)&&(this._isFirefox=!0),this._isEdge=!1,/Edge\/\d*\.\d*/.exec(navigator.userAgent)&&(this._isEdge=!0)}addLog(le){this._logs.push(le)}addChildGroup(le){0===le._logs.length||this._childGroups.push(le)}print(){return this._isEdge?this._printEdgeFriendly():void(this._openGroup(),this._logs.forEach((le)=>{this._printLogDetails(le)}),this._childGroups.forEach((le)=>{le.print()}),this._closeGroup())}_printEdgeFriendly(){this._logs.forEach((le)=>{let pe=le.message;'string'==typeof pe&&(pe=pe.replace(/%c/g,''));const he=[pe];le.error&&he.push(le.error),le.args&&he.push(le.args);const ge=le.logFunc||console.log;ge(...he)}),this._childGroups.forEach((le)=>{le.print()})}_printLogDetails(le){const ue=le.logFunc?le.logFunc:console.log;let pe=le.message,he=[pe];le.colors&&!this._isEdge&&(he=he.concat(le.colors)),le.args&&(he=he.concat(le.args)),ue(...he)}_openGroup(){if(this._isPrimary){if(0===this._childGroups.length)return;const le=this._logs.shift();if(this._isFirefox)return void this._printLogDetails(le);le.logFunc=console.group,this._printLogDetails(le)}else console.groupCollapsed(this._groupTitle)}_closeGroup(){this._isPrimary&&0===this._childGroups.length||console.groupEnd()}}self.goog=self.goog||{},self.goog.LOG_LEVEL=self.goog.LOG_LEVEL||{none:-1,verbose:0,debug:1,warn:2,error:3};const q=`#bdc3c7`,O=`#7f8c8d`,L=`#2ecc71`,T=`#f1c40f`,w=`#e74c3c`,I=`#3498db`;var A=new class LogHelper{constructor(){this._defaultLogLevel='localhost'===location.hostname?self.goog.LOG_LEVEL.debug:self.goog.LOG_LEVEL.none}log(le){this._printMessage(self.goog.LOG_LEVEL.verbose,le)}debug(le){this._printMessage(self.goog.LOG_LEVEL.debug,le)}warn(le){this._printMessage(self.goog.LOG_LEVEL.warn,le)}error(le){this._printMessage(self.goog.LOG_LEVEL.error,le)}_printMessage(le,ue){if(this._shouldLogMessage(le,ue)){const pe=this._getAllLogGroups(le,ue);pe.print()}}_getAllLogGroups(le,ue){const pe=new LogGroup({isPrimary:!0,title:'sw-helpers log.'}),he=this._getPrimaryMessageDetails(le,ue);if(pe.addLog(he),ue.error){const me={message:ue.error,logFunc:console.error};pe.addLog(me)}const ge=new LogGroup({title:'Extra Information.'});if(ue.that&&ue.that.constructor&&ue.that.constructor.name){const me=ue.that.constructor.name;ge.addLog(this._getKeyValueDetails('class',me))}return ue.data&&('object'!=typeof ue.data||ue.data instanceof Array?ge.addLog(this._getKeyValueDetails('additionalData',ue.data)):Object.keys(ue.data).forEach((me)=>{ge.addLog(this._getKeyValueDetails(me,ue.data[me]))})),pe.addChildGroup(ge),pe}_getKeyValueDetails(le,ue){return{message:`%c${le}: `,colors:[`color: ${I}`],args:ue}}_getPrimaryMessageDetails(le,ue){let pe,he;le===self.goog.LOG_LEVEL.verbose?(pe='Info',he=q):le===self.goog.LOG_LEVEL.debug?(pe='Debug',he=L):le===self.goog.LOG_LEVEL.warn?(pe='Warn',he=T):le===self.goog.LOG_LEVEL.error?(pe='Error',he=w):void 0;let ge=`%cðŸ”§ %c[${pe}]`;const me=[`color: ${q}`,`color: ${he}`];let fe;return'string'==typeof ue?fe=ue:ue.message&&(fe=ue.message),fe&&(ge+=`%c ${fe}`,me.push(`color: ${O}; font-weight: normal`)),{message:ge,colors:me}}_shouldLogMessage(le,ue){if(!ue)return!1;let pe=this._defaultLogLevel;return self&&self.goog&&'number'==typeof self.goog.logLevel&&(pe=self.goog.logLevel),pe===self.goog.LOG_LEVEL.none||le<pe?!1:!0}};class NavigationRoute extends Route{constructor({whitelist:le,blacklist:ue,handler:pe}={}){u.isArrayOfClass({whitelist:le},RegExp),ue?u.isArrayOfClass({blacklist:ue},RegExp):ue=[];super({match:({event:ge,url:me})=>{let ye,fe=!1;return'navigate'===ge.request.mode&&(le.some((_e)=>_e.test(me.pathname))?ue.some((_e)=>_e.test(me.pathname))?ye=`The navigation route is not being used, since the `+`request URL matches both the whitelist and blacklist.`:(ye=`The navigation route is being used.`,fe=!0):ye=`The navigation route is not being used, since the `+`URL being navigated to doesn't match the whitelist.`,A.debug({that:this,message:ye,data:{'request-url':me.href,whitelist:le,blacklist:ue,handler:pe}})),fe},handler:pe,method:'GET'})}}class RegExpRoute extends Route{constructor({regExp:le,handler:ue,method:pe}){u.isInstance({regExp:le},RegExp);super({match:({url:ge})=>{const me=le.exec(ge.href);return me?ge.origin!==location.origin&&0!==me.index?(A.debug({that:this,message:`Skipping route, because the RegExp match didn't occur `+`at the start of the URL.`,data:{url:ge.href,regExp:le}}),null):me.slice(1):null},handler:ue,method:pe})}}class Router$2{constructor(){this._routes=new Map,self.addEventListener('fetch',(le)=>{const ue=new URL(le.request.url);if(!ue.protocol.startsWith('http'))return void A.log({that:this,message:'URL does not start with HTTP and so not passing through the router.',data:{request:le.request}});let pe,he;for(let ge of this._routes.get(le.request.method)||[]){const me=ge.match({url:ue,event:le});if(me){he=ge,A.log({that:this,message:'The router found a matching route.',data:{route:he,request:le.request}});let fe=me;Array.isArray(fe)&&0===fe.length?fe=void 0:fe.constructor===Object&&0===Object.keys(fe).length&&(fe=void 0),pe=ge.handler.handle({url:ue,event:le,params:fe});break}}!pe&&this.defaultHandler&&(pe=this.defaultHandler.handle({url:ue,event:le})),pe&&this.catchHandler&&(pe=pe.catch((ge)=>{return this.catchHandler.handle({url:ue,event:le,error:ge})})),pe&&le.respondWith(pe.then((ge)=>{return A.debug({that:this,message:'The router is managing a route with a response.',data:{route:he,request:le.request,response:ge}}),ge}))})}setDefaultHandler({handler:le}={}){u.hasMethod({handler:le},'handle'),this.defaultHandler=le}setCatchHandler({handler:le}={}){u.hasMethod({handler:le},'handle'),this.catchHandler=le}registerRoutes({routes:le}={}){u.isArrayOfClass({routes:le},Route);for(let ue of le)this._routes.has(ue.method)||this._routes.set(ue.method,[]),this._routes.get(ue.method).unshift(ue)}registerRoute({route:le}={}){u.isInstance({route:le},Route),this.registerRoutes({routes:[le]})}}class Router$$1 extends Router$2{constructor(le){super(),this._revisionedCacheName=le}registerRoute(le,ue){if('function'==typeof ue&&(ue={handle:ue}),'string'==typeof le){if(0===le.length)throw r.createError('empty-express-string');super.registerRoute({route:new ExpressRoute({path:le,handler:ue})})}else if(le instanceof RegExp)super.registerRoute({route:new RegExpRoute({regExp:le,handler:ue})});else if(le instanceof Route)super.registerRoute({route:le});else throw r.createError('unsupported-route-type')}registerNavigationRoute(le,ue={}){if('string'!=typeof le)throw r.createError('navigation-route-url-string');const pe='cacheName'in ue?ue.cacheName:this._revisionedCacheName;super.registerRoute({route:new NavigationRoute({handler:()=>caches.match(le,{cacheName:pe}),whitelist:ue.whitelist||[/./],blacklist:ue.blacklist||[]})})}}let D=`sw-runtime-caching`;self&&self.registration&&(D+=`-${self.registration.scope}`);const S=D,W=['cacheDidUpdate','cacheWillMatch','cacheWillUpdate','fetchDidFail','requestWillFetch'];var M=new ErrorFactory$1({'multiple-cache-will-update-plugins':'You cannot register more than one plugin that implements cacheWillUpdate.','multiple-cache-will-match-plugins':'You cannot register more than one plugin that implements cacheWillMatch.','invalid-reponse-for-caching':'The fetched response could not be cached due to an invalid response code, by default only 20X responses can be cached.'}),F=function(le){return function(){var ue=le.apply(this,arguments);return new Promise(function(pe,he){function step(ge,me){try{var fe=ue[ge](me),ye=fe.value}catch(_e){return void he(_e)}return fe.done?void pe(ye):Promise.resolve(ye).then(function(_e){step('next',_e)},function(_e){step('throw',_e)})}return step('next')})}};class RequestWrapper{constructor({cacheName:le,plugins:ue,fetchOptions:pe,matchOptions:he}={}){if(le?(u.isType({cacheName:le},'string'),this.cacheName=le):this.cacheName=S,pe&&(u.isType({fetchOptions:pe},'object'),this.fetchOptions=pe),he&&(u.isType({matchOptions:he},'object'),this.matchOptions=he),this.pluginCallbacks={},ue&&(u.isArrayOfType({plugins:ue},'object'),ue.forEach((ge)=>{for(let me of W)'function'==typeof ge[me]&&(this.pluginCallbacks[me]||(this.pluginCallbacks[me]=[]),this.pluginCallbacks[me].push(ge[me].bind(ge)))})),this.pluginCallbacks.cacheWillUpdate&&1!==this.pluginCallbacks.cacheWillUpdate.length)throw M.createError('multiple-cache-will-update-plugins');if(this.pluginCallbacks.cacheWillMatch&&1!==this.pluginCallbacks.cacheWillMatch.length)throw M.createError('multiple-cache-will-match-plugins')}getCache(){var le=this;return F(function*(){return le._cache||(le._cache=yield caches.open(le.cacheName)),le._cache})()}match({request:le}){var ue=this;return F(function*(){u.atLeastOne({request:le});const pe=yield ue.getCache();let he=yield pe.match(le,ue.matchOptions);return ue.pluginCallbacks.cacheWillMatch&&(he=ue.pluginCallbacks.cacheWillMatch[0]({cachedResponse:he})),he})()}fetch({request:le}){var ue=this;return F(function*(){u.atLeastOne({request:le});const pe=ue.pluginCallbacks.fetchDidFail?le.clone():null;if(ue.pluginCallbacks.requestWillFetch)for(let he of ue.pluginCallbacks.requestWillFetch){const ge=he({request:le});u.isInstance({returnedPromise:ge},Promise);const me=yield ge;u.isInstance({returnedRequest:me},Request),le=me}try{return yield fetch(le,ue.fetchOptions)}catch(he){if(ue.pluginCallbacks.fetchDidFail)for(let ge of ue.pluginCallbacks.fetchDidFail)ge({request:pe.clone()});throw he}})()}fetchAndCache({request:le,waitOnCache:ue,cacheKey:pe}){var he=this;return F(function*(){u.atLeastOne({request:le});let ge;const me=yield he.fetch({request:le});let fe=me.ok;if(he.pluginCallbacks.cacheWillUpdate&&(fe=he.pluginCallbacks.cacheWillUpdate[0]({request:le,response:me})),fe){const ye=me.clone();ge=he.getCache().then((()=>{var _e=F(function*(be){let ve;'opaque'!==me.type&&he.pluginCallbacks.cacheDidUpdate&&(ve=yield he.match({request:le}));yield be.put(pe||le,ye);for(let Ne of he.pluginCallbacks.cacheDidUpdate||[])Ne({cacheName:he.cacheName,oldResponse:ve,newResponse:ye,url:le.url})});return function(){return _e.apply(this,arguments)}})())}else if(!fe&&(A.debug(`[RequestWrapper] The response for ${le.url}, with 
        a status of ${me.status}, wasn't cached. By default, only
        responses with a status of 200 are cached. You can configure the
        cacheableResponse plugin to change this default.`.replace(/\s+/g,' ')),ue))throw M.createError('invalid-reponse-for-caching');return ue&&ge&&(yield ge),me})()}}class Handler{constructor({requestWrapper:le}={}){this.requestWrapper=le?le:new RequestWrapper}handle({event:le,params:ue}={}){throw Error('This abstract method must be implemented in a subclass.')}}class CacheFirst extends Handler{handle({event:le}={}){var ue=this;return F(function*(){u.isInstance({event:le},FetchEvent);const pe=yield ue.requestWrapper.match({request:le.request});return pe||(yield ue.requestWrapper.fetchAndCache({request:le.request}))})()}}class CacheOnly extends Handler{handle({event:le}={}){var ue=this;return F(function*(){return u.isInstance({event:le},FetchEvent),yield ue.requestWrapper.match({request:le.request})})()}}class NetworkFirst extends Handler{constructor(le={}){super(le);const{networkTimeoutSeconds:ue}=le;ue&&(u.isType({networkTimeoutSeconds:ue},'number'),this.networkTimeoutSeconds=ue)}handle({event:le}={}){var ue=this;return F(function*(){u.isInstance({event:le},FetchEvent);const pe=[];let he;return ue.networkTimeoutSeconds&&pe.push(new Promise(function(ge){he=setTimeout(function(){ge(ue.requestWrapper.match({request:le.request}))},1e3*ue.networkTimeoutSeconds)})),pe.push(ue.requestWrapper.fetchAndCache({request:le.request}).then(function(ge){return he&&clearTimeout(he),ge?ge:Promise.reject('No response received; falling back to cache.')}).catch(function(){return ue.requestWrapper.match({request:le.request})})),Promise.race(pe)})()}}class NetworkOnly extends Handler{handle({event:le}={}){var ue=this;return F(function*(){return u.isInstance({event:le},FetchEvent),yield ue.requestWrapper.fetch({request:le.request})})()}}class StaleWhileRevalidate extends Handler{handle({event:le}={}){var ue=this;return F(function*(){u.isInstance({event:le},FetchEvent);const pe=ue.requestWrapper.fetchAndCache({request:le.request}).catch(function(){return Response.error()}),he=yield ue.requestWrapper.match({request:le.request});return he||(yield pe)})()}}let R=`sw-cache-expiration`;self&&self.registration&&(R+=`-${self.registration.scope}`);const G=R,V='url',B='timestamp';var K=createCommonjsModule(function(le){'use strict';(function(){function toArray(pe){return Array.prototype.slice.call(pe)}function promisifyRequest(pe){return new Promise(function(he,ge){pe.onsuccess=function(){he(pe.result)},pe.onerror=function(){ge(pe.error)}})}function promisifyRequestCall(pe,he,ge){var me,fe=new Promise(function(ye,_e){me=pe[he].apply(pe,ge),promisifyRequest(me).then(ye,_e)});return fe.request=me,fe}function promisifyCursorRequestCall(pe,he,ge){var me=promisifyRequestCall(pe,he,ge);return me.then(function(fe){return fe?new Cursor(fe,me.request):void 0})}function proxyProperties(pe,he,ge){ge.forEach(function(me){Object.defineProperty(pe.prototype,me,{get:function(){return this[he][me]},set:function(fe){this[he][me]=fe}})})}function proxyRequestMethods(pe,he,ge,me){me.forEach(function(fe){fe in ge.prototype&&(pe.prototype[fe]=function(){return promisifyRequestCall(this[he],fe,arguments)})})}function proxyMethods(pe,he,ge,me){me.forEach(function(fe){fe in ge.prototype&&(pe.prototype[fe]=function(){return this[he][fe].apply(this[he],arguments)})})}function proxyCursorRequestMethods(pe,he,ge,me){me.forEach(function(fe){fe in ge.prototype&&(pe.prototype[fe]=function(){return promisifyCursorRequestCall(this[he],fe,arguments)})})}function Index(pe){this._index=pe}function Cursor(pe,he){this._cursor=pe,this._request=he}function ObjectStore(pe){this._store=pe}function Transaction(pe){this._tx=pe,this.complete=new Promise(function(he,ge){pe.oncomplete=function(){he()},pe.onerror=function(){ge(pe.error)},pe.onabort=function(){ge(pe.error)}})}function UpgradeDB(pe,he,ge){this._db=pe,this.oldVersion=he,this.transaction=new Transaction(ge)}function DB(pe){this._db=pe}proxyProperties(Index,'_index',['name','keyPath','multiEntry','unique']),proxyRequestMethods(Index,'_index',IDBIndex,['get','getKey','getAll','getAllKeys','count']),proxyCursorRequestMethods(Index,'_index',IDBIndex,['openCursor','openKeyCursor']),proxyProperties(Cursor,'_cursor',['direction','key','primaryKey','value']),proxyRequestMethods(Cursor,'_cursor',IDBCursor,['update','delete']),['advance','continue','continuePrimaryKey'].forEach(function(pe){pe in IDBCursor.prototype&&(Cursor.prototype[pe]=function(){var he=this,ge=arguments;return Promise.resolve().then(function(){return he._cursor[pe].apply(he._cursor,ge),promisifyRequest(he._request).then(function(me){return me?new Cursor(me,he._request):void 0})})})}),ObjectStore.prototype.createIndex=function(){return new Index(this._store.createIndex.apply(this._store,arguments))},ObjectStore.prototype.index=function(){return new Index(this._store.index.apply(this._store,arguments))},proxyProperties(ObjectStore,'_store',['name','keyPath','indexNames','autoIncrement']),proxyRequestMethods(ObjectStore,'_store',IDBObjectStore,['put','add','delete','clear','get','getAll','getKey','getAllKeys','count']),proxyCursorRequestMethods(ObjectStore,'_store',IDBObjectStore,['openCursor','openKeyCursor']),proxyMethods(ObjectStore,'_store',IDBObjectStore,['deleteIndex']),Transaction.prototype.objectStore=function(){return new ObjectStore(this._tx.objectStore.apply(this._tx,arguments))},proxyProperties(Transaction,'_tx',['objectStoreNames','mode']),proxyMethods(Transaction,'_tx',IDBTransaction,['abort']),UpgradeDB.prototype.createObjectStore=function(){return new ObjectStore(this._db.createObjectStore.apply(this._db,arguments))},proxyProperties(UpgradeDB,'_db',['name','version','objectStoreNames']),proxyMethods(UpgradeDB,'_db',IDBDatabase,['deleteObjectStore','close']),DB.prototype.transaction=function(){return new Transaction(this._db.transaction.apply(this._db,arguments))},proxyProperties(DB,'_db',['name','version','objectStoreNames']),proxyMethods(DB,'_db',IDBDatabase,['close']),['openCursor','openKeyCursor'].forEach(function(pe){[ObjectStore,Index].forEach(function(he){he.prototype[pe.replace('open','iterate')]=function(){var ge=toArray(arguments),me=ge[ge.length-1],fe=this._store||this._index,ye=fe[pe].apply(fe,ge.slice(0,-1));ye.onsuccess=function(){me(ye.result)}}})}),[Index,ObjectStore].forEach(function(pe){pe.prototype.getAll||(pe.prototype.getAll=function(he,ge){var me=this,fe=[];return new Promise(function(ye){me.iterateCursor(he,function(_e){return _e?(fe.push(_e.value),void 0!==ge&&fe.length==ge?void ye(fe):void _e.continue()):void ye(fe)})})})});le.exports={open:function(pe,he,ge){var me=promisifyRequestCall(indexedDB,'open',[pe,he]),fe=me.request;return fe.onupgradeneeded=function(ye){ge&&ge(new UpgradeDB(fe.result,ye.oldVersion,fe.transaction))},me.then(function(ye){return new DB(ye)})},delete:function(pe){return promisifyRequestCall(indexedDB,'deleteDatabase',[pe])}}})()});const H={'max-entries-or-age-required':`Either the maxEntries or maxAgeSeconds
    parameters (or both) are required when constructing Plugin.`,'max-entries-must-be-number':`The maxEntries parameter to the Plugin
    constructor must either be a number or undefined.`,'max-age-seconds-must-be-number':`The maxAgeSeconds parameter to the Plugin
    constructor must either be a number or undefined.`};var $=new ErrorFactory$1(H);class Plugin{constructor({maxEntries:le,maxAgeSeconds:ue}={}){if(!(le||ue))throw $.createError('max-entries-or-age-required');if(le&&'number'!=typeof le)throw $.createError('max-entries-must-be-number');if(ue&&'number'!=typeof ue)throw $.createError('max-age-seconds-must-be-number');this.maxEntries=le,this.maxAgeSeconds=ue,this._dbs=new Map,this._caches=new Map}getDB({cacheName:le}={}){var ue=this;return F(function*(){u.isType({cacheName:le},'string');const pe=`${G}-${le}`;if(!ue._dbs.has(pe)){const he=yield K.open(pe,1,function(ge){const me=ge.createObjectStore(le,{keyPath:V});me.createIndex(B,B,{unique:!1})});ue._dbs.set(pe,he)}return ue._dbs.get(pe)})()}getCache({cacheName:le}={}){var ue=this;return F(function*(){if(u.isType({cacheName:le},'string'),!ue._caches.has(le)){const pe=yield caches.open(le);ue._caches.set(le,pe)}return ue._caches.get(le)})()}cacheWillMatch({cachedResponse:le,now:ue}={}){return this.isResponseFresh({cachedResponse:le,now:ue})?le:null}isResponseFresh({cachedResponse:le,now:ue}={}){if(le&&this.maxAgeSeconds){u.isInstance({cachedResponse:le},Response);const pe=le.headers.get('date');if(pe){'undefined'==typeof ue&&(ue=Date.now());const he=new Date(pe);if(he.getTime()+1e3*this.maxAgeSeconds<ue)return!1}}return!0}cacheDidUpdate({cacheName:le,newResponse:ue,url:pe,now:he}={}){u.isType({cacheName:le},'string'),u.isInstance({newResponse:ue},Response),'undefined'==typeof he&&(he=Date.now()),this.updateTimestamp({cacheName:le,url:pe,now:he}).then(()=>{this.expireEntries({cacheName:le,now:he})})}updateTimestamp({cacheName:le,url:ue,now:pe}={}){var he=this;return F(function*(){u.isType({url:ue},'string'),u.isType({cacheName:le},'string'),'undefined'==typeof pe&&(pe=Date.now());const ge=yield he.getDB({cacheName:le}),me=ge.transaction(le,'readwrite');me.objectStore(le).put({[B]:pe,[V]:ue}),yield me.complete})()}expireEntries({cacheName:le,now:ue}={}){var pe=this;return F(function*(){u.isType({cacheName:le},'string'),'undefined'==typeof ue&&(ue=Date.now());const he=pe.maxAgeSeconds?yield pe.findOldEntries({cacheName:le,now:ue}):[],ge=pe.maxEntries?yield pe.findExtraEntries({cacheName:le}):[],me=[...new Set(he.concat(ge))];return yield pe.deleteFromCacheAndIDB({cacheName:le,urls:me}),me})()}findOldEntries({cacheName:le,now:ue}={}){var pe=this;return F(function*(){u.isType({cacheName:le},'string'),u.isType({now:ue},'number');const he=ue-1e3*pe.maxAgeSeconds,ge=[],me=yield pe.getDB({cacheName:le}),fe=me.transaction(le,'readonly'),ye=fe.objectStore(le),_e=ye.index(B);return _e.iterateCursor(function(be){be&&(be.value[B]<he&&ge.push(be.value[V]),be.continue())}),yield fe.complete,ge})()}findExtraEntries({cacheName:le}={}){var ue=this;return F(function*(){u.isType({cacheName:le},'string');const pe=[],he=yield ue.getDB({cacheName:le});let ge=he.transaction(le,'readonly'),me=ge.objectStore(le),fe=me.index(B);const ye=yield fe.count();return ye>ue.maxEntries&&(ge=he.transaction(le,'readonly'),me=ge.objectStore(le),fe=me.index(B),fe.iterateCursor(function(_e){_e&&(pe.push(_e.value[V]),ye-pe.length>ue.maxEntries&&_e.continue())})),yield ge.complete,pe})()}deleteFromCacheAndIDB({cacheName:le,urls:ue}={}){var pe=this;return F(function*(){if(u.isType({cacheName:le},'string'),u.isArrayOfType({urls:ue},'string'),0<ue.length){const he=yield pe.getCache({cacheName:le}),ge=yield pe.getDB({cacheName:le});yield ue.forEach((()=>{var me=F(function*(fe){yield he.delete(fe);const ye=ge.transaction(le,'readwrite'),_e=ye.objectStore(le);yield _e.delete(fe),yield ye.complete});return function(){return me.apply(this,arguments)}})())}})()}}const Y={'channel-name-required':`The channelName parameter is required when
    constructing a new BroadcastCacheUpdate instance.`,'responses-are-same-parameters-required':`The first, second, and
    headersToCheck parameters must be valid when calling responsesAreSame()`};var z=new ErrorFactory$1(Y);const X='CACHE_UPDATED',Q=['content-length','etag','last-modified'];class BroadcastCacheUpdate{constructor({channelName:le,headersToCheck:ue,source:pe}={}){if('string'!=typeof le||0===le.length)throw z.createError('channel-name-required');this.channelName=le,this.headersToCheck=ue||Q,this.source=pe||'sw-broadcast-cache-update'}get channel(){return this._channel||(this._channel=new BroadcastChannel(this.channelName)),this._channel}notifyIfUpdated({first:le,second:ue,cacheName:pe}){u.isType({cacheName:pe},'string'),responsesAreSame({first:le,second:ue,headersToCheck:this.headersToCheck})||broadcastUpdate({cacheName:pe,url:ue.url,channel:this.channel,source:this.source})}}class BroadcastCacheUpdatePlugin extends BroadcastCacheUpdate{cacheDidUpdate({cacheName:le,oldResponse:ue,newResponse:pe}){u.isType({cacheName:le},'string'),u.isInstance({newResponse:pe},Response),ue&&this.notifyIfUpdated({cacheName:le,first:ue,second:pe})}}class CacheableResponse{constructor({statuses:le,headers:ue}={}){u.atLeastOne({statuses:le,headers:ue}),le!==void 0&&u.isArrayOfType({statuses:le},'number'),ue!==void 0&&u.isType({headers:ue},'object'),this.statuses=le,this.headers=ue}isResponseCacheable({response:le}={}){u.isInstance({response:le},Response);let ue=!0;if(this.statuses&&(ue=this.statuses.includes(le.status)),this.headers&&ue&&(ue=Object.keys(this.headers).some((pe)=>{return le.headers.get(pe)===this.headers[pe]})),!ue){const pe={response:le};this.statuses&&(pe['valid-status-codes']=JSON.stringify(this.statuses)),this.headers&&(pe['valid-headers']=JSON.stringify(this.headers)),A.debug({message:`The response does not meet the criteria for being added `+`to the cache.`,data:pe})}return ue}}class CacheableResponsePlugin extends CacheableResponse{cacheWillUpdate({response:le}={}){return this.isResponseCacheable({response:le})}}class Strategies{cacheFirst(le){return this._getCachingMechanism(CacheFirst,le)}cacheOnly(le){return this._getCachingMechanism(CacheOnly,le)}networkFirst(le){return this._getCachingMechanism(NetworkFirst,le)}networkOnly(le){return this._getCachingMechanism(NetworkOnly,le)}staleWhileRevalidate(le){return this._getCachingMechanism(StaleWhileRevalidate,le)}_getCachingMechanism(le,ue={}){const pe={cacheExpiration:Plugin,broadcastCacheUpdate:BroadcastCacheUpdatePlugin,cacheableResponse:CacheableResponsePlugin},he={plugins:[]};ue.cacheName&&(he.cacheName=ue.cacheName);const ge=Object.keys(pe);return ge.forEach((me)=>{if(ue[me]){const fe=pe[me],ye=ue[me];he.plugins.push(new fe(ye))}}),ue.plugins&&ue.plugins.forEach((me)=>{he.plugins.push(me)}),new le({requestWrapper:new RequestWrapper(he)})}}const Z={'not-in-sw':'sw-precaching must be loaded in your service worker file.','invalid-revisioned-entry':`File manifest entries must be either a `+`string with revision info in the url or an object with a 'url' and `+`'revision' parameters.`,'invalid-unrevisioned-entry':``,'bad-cache-bust':`The cache bust parameter must be a boolean.`,'duplicate-entry-diff-revisions':`An attempt was made to cache the same `+`url twice with each having different revisions. This is not supported.`,'request-not-cached':`A request failed the criteria to be cached. By `+`default, only responses with 'response.ok = true' are cached.`,'should-override':'Method should be overridden by the extending class.'};var ee=new ErrorFactory$1(Z);class BaseCacheManager{constructor(le){this._entriesToCache=new Map,this._requestWrapper=new RequestWrapper({cacheName:le,fetchOptions:{credentials:'same-origin'}}),this._cacheName=this._requestWrapper.cacheName}_addEntries(le){this._parsedCacheUrls=null,le.forEach((ue)=>{this._addEntryToInstallList(this._parseEntry(ue))})}getCacheName(){return this._cacheName}getCachedUrls(){return this._parsedCacheUrls||(this._parsedCacheUrls=Array.from(this._entriesToCache.keys()).map((le)=>new URL(le,location).href)),this._parsedCacheUrls}_addEntryToInstallList(le){const ue=le.entryID,pe=this._entriesToCache.get(le.entryID);return pe?void this._onDuplicateInstallEntryFound(le,pe):void this._entriesToCache.set(ue,le)}install(){var le=this;return F(function*(){if(0!==le._entriesToCache.size){const ue=[];return le._entriesToCache.forEach(function(pe){ue.push(le._cacheEntry(pe))}),Promise.all(ue)}})()}_cacheEntry(le){var ue=this;return F(function*(){const pe=yield ue._isAlreadyCached(le);if(!pe)try{return yield ue._requestWrapper.fetchAndCache({request:le.getNetworkRequest(),waitOnCache:!0,cacheKey:le.request}),ue._onEntryCached(le)}catch(he){throw ee.createError('request-not-cached',{message:`Failed to get a cacheable response for `+`'${le.request.url}': ${he.message}`})}})()}cleanup(){var le=this;return F(function*(){if(yield caches.has(le._cacheName)){const ue=[];le._entriesToCache.forEach(function(me){ue.push(me.request.url)});const pe=yield le._getCache(),he=yield pe.keys(),ge=he.filter(function(me){return!ue.includes(me.url)});return Promise.all(ge.map(function(me){return pe.delete(me)}))}})()}_getCache(){var le=this;return F(function*(){return le._cache||(le._cache=yield caches.open(le._cacheName)),le._cache})()}_parseEntry(){throw ee.createError('should-override')}_onDuplicateEntryFound(){throw ee.createError('should-override')}_isAlreadyCached(){throw ee.createError('should-override')}_onEntryCached(){throw ee.createError('should-override')}}class IDBHelper{constructor(le,ue,pe){if(le==void 0||ue==void 0||pe==void 0)throw Error('name, version, storeName must be passed to the constructor.');this._name=le,this._version=ue,this._storeName=pe}_getDb(){return this._dbPromise?this._dbPromise:(this._dbPromise=K.open(this._name,this._version,(le)=>{le.createObjectStore(this._storeName)}).then((le)=>{return le}),this._dbPromise)}close(){return this._dbPromise?this._dbPromise.then((le)=>{le.close(),this._dbPromise=null}):void 0}put(le,ue){return this._getDb().then((pe)=>{const he=pe.transaction(this._storeName,'readwrite'),ge=he.objectStore(this._storeName);return ge.put(ue,le),he.complete})}delete(le){return this._getDb().then((ue)=>{const pe=ue.transaction(this._storeName,'readwrite'),he=pe.objectStore(this._storeName);return he.delete(le),pe.complete})}get(le){return this._getDb().then((ue)=>{return ue.transaction(this._storeName).objectStore(this._storeName).get(le)})}getAllValues(){return this._getDb().then((le)=>{return le.transaction(this._storeName).objectStore(this._storeName).getAll()})}getAllKeys(){return this._getDb().then((le)=>{return le.transaction(this._storeName).objectStore(this._storeName).getAllKeys()})}}let oe=`sw-precaching-revisioned-${'v1'}`;self&&self.registration&&(oe+=`-${self.registration.scope}`);const ce=oe;class RevisionDetailsModel{constructor(){this._idbHelper=new IDBHelper('sw-precaching','1','asset-revisions')}get(le){return this._idbHelper.get(le)}put(le,ue){return this._idbHelper.put(le,ue)}_close(){this._idbHelper.close()}}class BaseCacheEntry{constructor({entryID:le,revision:ue,request:pe,cacheBust:he}){this.entryID=le,this.revision=ue,this.request=pe,this.cacheBust=he}getNetworkRequest(){if(!0!==this.cacheBust)return this.request;let le=this.request.url;const ue={};if(!0===this.cacheBust)if('cache'in Request.prototype)ue.cache='reload';else{const pe=new URL(le,location);pe.search+=(pe.search?'&':'')+encodeURIComponent('_sw-precaching')+'='+encodeURIComponent(this.revision),le=pe.toString()}return new Request(le,ue)}}class StringCacheEntry extends BaseCacheEntry{constructor(le){if(u.isType({url:le},'string'),0===le.length)throw ee.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(le)));super({entryID:le,revision:le,request:new Request(le),cacheBust:!1})}}class DefaultsCacheEntry extends BaseCacheEntry{constructor({entryID:le,revision:ue,url:pe,cacheBust:he}){if('undefined'==typeof he&&(he=!0),'undefined'==typeof le&&(le=new URL(pe,location).toString()),u.isType({revision:ue},'string'),0===ue.length)throw ee.createError('invalid-revisioned-entry',new Error('Bad revision Parameter. It should be a string with at least one character: '+JSON.stringify(ue)));if(u.isType({url:pe},'string'),0===pe.length)throw ee.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(pe)));if(u.isType({entryID:le},'string'),0===le.length)throw ee.createError('invalid-revisioned-entry',new Error('Bad entryID Parameter. It should be a string with at least one character: '+JSON.stringify(le)));u.isType({cacheBust:he},'boolean'),super({entryID:le,revision:ue,request:new Request(pe),cacheBust:he})}}class RevisionedCacheManager extends BaseCacheManager{constructor({cacheName:le}={}){le=le||ce,super(le),this._revisionDetailsModel=new RevisionDetailsModel}addToCacheList({revisionedFiles:le}={}){u.isInstance({revisionedFiles:le},Array),super._addEntries(le)}_parseEntry(le){if('undefined'==typeof le||null===le)throw ee.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(le)));let ue;switch(typeof le){case'string':ue=new StringCacheEntry(le);break;case'object':ue=new DefaultsCacheEntry(le);break;default:throw ee.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ue)));}return ue}_onDuplicateInstallEntryFound(le,ue){if(ue.revision!==le.revision)throw ee.createError('duplicate-entry-diff-revisions',new Error(`${JSON.stringify(ue)} <=> `+`${JSON.stringify(le)}`))}_isAlreadyCached(le){var ue=this;return F(function*(){const pe=yield ue._revisionDetailsModel.get(le.entryID);if(pe!==le.revision)return!1;const he=yield ue._getCache(),ge=yield he.match(le.request);return!!ge})()}_onEntryCached(le){var ue=this;return F(function*(){yield ue._revisionDetailsModel.put(le.entryID,le.revision)})()}_close(){this._revisionDetailsModel._close()}cleanup(){return super.cleanup().then(()=>{return this._close()})}}class RequestCacheEntry extends BaseCacheEntry{constructor(le){if(!(le instanceof Request))throw ee.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(le)));super({entryID:le.url,request:le,cacheBust:!1})}}class UnrevisionedCacheManager extends BaseCacheManager{constructor({cacheName:le}={}){super(le)}addToCacheList({unrevisionedFiles:le}={}){u.isInstance({unrevisionedFiles:le},Array),super._addEntries(le)}_parseEntry(le){if('undefined'==typeof le||null===le)throw ee.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(le)));if('string'==typeof le)return new StringCacheEntry(le);if(le instanceof Request)return new RequestCacheEntry(le);throw ee.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(le)))}_onDuplicateInstallEntryFound(){}_isAlreadyCached(){return F(function*(){return!1})()}_onEntryCached(){}}if(!u.isSWEnv())throw ee.createError('not-in-sw');class SWLib{constructor(){this._revisionedCacheManager=new RevisionedCacheManager,this._router=new Router$$1(this._revisionedCacheManager.getCacheName()),this._unrevisionedCacheManager=new UnrevisionedCacheManager,this._strategies=new Strategies,this._registerInstallActivateEvents(),this._registerDefaultRoutes()}cacheRevisionedAssets(le){if(!Array.isArray(le))throw r.createError('bad-revisioned-cache-list');this._revisionedCacheManager.addToCacheList({revisionedFiles:le})}warmRuntimeCache(le){if(!Array.isArray(le))throw r.createError('bad-revisioned-cache-list');this._unrevisionedCacheManager.addToCacheList({unrevisionedFiles:le})}get router(){return this._router}get strategies(){return this._strategies}_registerInstallActivateEvents(){self.addEventListener('install',(le)=>{le.waitUntil(Promise.all([this._revisionedCacheManager.install(),this._unrevisionedCacheManager.install()]))}),self.addEventListener('activate',(le)=>{le.waitUntil(Promise.all([this._revisionedCacheManager.cleanup(),this._unrevisionedCacheManager.cleanup()]))})}_registerDefaultRoutes(){const le=this.strategies.cacheFirst({cacheName:this._revisionedCacheManager.getCacheName()}),ue=new Route({match:({url:pe,event:he})=>{const ge=this._revisionedCacheManager.getCachedUrls();return-1!==ge.indexOf(pe.href)},handler:le});this.router.registerRoute(ue)}}if(!u.isSWEnv())throw r.createError('not-in-sw');const de=new SWLib;return de});
//# sourceMappingURL=sw-lib.min.js.map
